<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.order.mapper.OrderMapper">
	<insert id="insertOrder" parameterType="OrderVO">	
		<selectKey keyProperty="ordId" resultType="int" order="BEFORE">
    		SELECT seq_order_id.NEXTVAL FROM dual
  		</selectKey>
		
		INSERT INTO orders(ord_id,mem_id,ord_status,ord_receiver,ord_addr,ord_phone,ord_postcode,ord_totalprice)
		VALUES(#{ordId},#{memId}, #{ordStatus}, #{ordReceiver}, #{ordAddr}, #{ordPhone}, #{ordPostcode},#{ordTotalprice})
	</insert>
	
	<select id="myOrder" resultType="OrderVO">
		SELECT * 
	    FROM orders o JOIN orderproduct p
        ON o.ord_id = p.ord_id
        WHERE mem_id = #{memId}
	</select>

</mapper>